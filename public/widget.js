function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(t,e){t.appendChild(e)}function c(t){t.parentNode.removeChild(t)}function s(t){return document.createElement(t)}function l(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}let f;function p(t){f=t}const d=[],h=[],y=[],v=[],g=Promise.resolve();let w=!1;function b(t){y.push(t)}const m=new Set;let _=0;function O(){const t=f;do{for(;_<d.length;){const t=d[_];_++,p(t),C(t.$$)}for(p(null),d.length=0,_=0;h.length;)h.pop()();for(let t=0;t<y.length;t+=1){const e=y[t];m.has(e)||(m.add(e),e())}y.length=0}while(d.length);for(;v.length;)v.pop()();w=!1,m.clear(),p(t)}function C(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(b)}}const k=new Set;function E(t,e){-1===t.$$.dirty[0]&&(d.push(t),w||(w=!0,g.then(O)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function T(i,a,u,s,l,d,h,y=[-1]){const v=f;p(i);const g=i.$$={fragment:null,ctx:null,props:d,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a.context||(v?v.$$.context:[])),callbacks:n(),dirty:y,skip_bound:!1,root:a.target||v.$$.root};h&&h(g.root);let w=!1;if(g.ctx=u?u(i,a.props||{},((t,e,...n)=>{const r=n.length?n[0]:e;return g.ctx&&l(g.ctx[t],g.ctx[t]=r)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](r),w&&E(i,t)),e})):[],g.update(),w=!0,r(g.before_update),g.fragment=!!s&&s(g.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);g.fragment&&g.fragment.l(t),t.forEach(c)}else g.fragment&&g.fragment.c();a.intro&&((m=i.$$.fragment)&&m.i&&(k.delete(m),m.i(_))),function(t,n,i,a){const{fragment:u,on_mount:c,on_destroy:s,after_update:l}=t.$$;u&&u.m(n,i),a||b((()=>{const n=c.map(e).filter(o);s?s.push(...n):r(n),t.$$.on_mount=[]})),l.forEach(b)}(i,a.target,a.anchor,a.customElement),O()}var m,_;p(v)}const S=[];var A,P=function(){return P=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},P.apply(this,arguments)},x=function(){function t(){}return t.set=function(t){if(!this.isValid(t))throw new Error("Configuration is invalid");t.serverConfig&&this.validateServerConfig(t.serverConfig),this.options=P({},t)},t.get=function(t){if(!this.options&&!t)throw new Error("Configuration has not been set");var e=P(P({},this.options),t);if(!e.serverConfig||!e.serverConfig.baseUrl)throw new Error("Server configuration has not been set");return e},t.isValid=function(t){return!(!t||!t.serverConfig)},t.validateServerConfig=function(t){t.timeout||(t.timeout=6e4);var e=t.baseUrl;e&&"/"!==e.charAt(e.length-1)&&(t.baseUrl=e+"/")},t}();!function(t){t.Authenticate="AUTHENTICATE",t.Authorize="AUTHORIZE",t.EndSession="END_SESSION",t.Logout="LOGOUT",t.ExchangeToken="EXCHANGE_TOKEN",t.RefreshToken="REFRESH_TOKEN",t.ResumeAuthenticate="RESUME_AUTHENTICATE",t.RevokeToken="REVOKE_TOKEN",t.StartAuthenticate="START_AUTHENTICATE",t.UserInfo="USER_INFO"}(A||(A={}));function N(t,e){void 0===e&&(e=6e4);var n=e||6e4;return Promise.race([t,new Promise((function(t,e){return window.setTimeout((function(){return e(new Error("Timeout"))}),n)}))])}var I=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};function j(t){var e="http:"===t.protocol&&-1===["","80"].indexOf(t.port)||"https:"===t.protocol&&-1===["","443"].indexOf(t.port)?":"+t.port:"";return t.protocol+"//"+t.hostname+e}function R(t,e,n){var r=function(t){var e=(t||"").split("/").map((function(t){return t.trim()})).filter((function(t){return""!==t}));return"root"!==e[0]&&e.unshift("root"),e.map((function(t){return"realms/"+t})).join("/")}(e),o={authenticate:"json/"+r+"/authenticate",authorize:"oauth2/"+r+"/authorize",accessToken:"oauth2/"+r+"/access_token",endSession:"oauth2/"+r+"/connect/endSession",userInfo:"oauth2/"+r+"/userinfo",revoke:"oauth2/"+r+"/token/revoke",sessions:"json/"+r+"/sessions/"};return n&&n[t]?n[t]:o[t]}function U(t,e){var n=new URL(t);if(e.startsWith("/"))return""+j(n)+e;var r=n.pathname.split("/"),o=e.split("/").filter((function(t){return!!t})),i=I(I([],r.slice(0,-1)),o).join("/");return""+j(n)+i}function V(t){var e=[];for(var n in t)t[n]&&e.push(n+"="+encodeURIComponent(t[n]));return e.join("&")}function B(t,e){var n=e.type,r=e.payload,o=Object.freeze({type:n,payload:r});return function(e){if(!Array.isArray(e))return t;var n=e.map((function(t){return t}));return function e(){var r=n.shift();return r&&r(t,o,e),t}()}}var L,M,q=function(){return q=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},q.apply(this,arguments)},D=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},$=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},F=function(){function t(){}return t.next=function(t,e){return D(this,void 0,void 0,(function(){var n,r,o,i,a,u,c,s,l,f,p;return $(this,(function(d){switch(d.label){case 0:return n=x.get(e),r=n.middleware,o=n.realmPath,i=n.serverConfig,a=n.tree,u=n.type,c=e?e.query:{},s=this.constructUrl(i,o,a,c),l=B({url:new URL(s),init:this.configureRequest(t)},{type:t?A.Authenticate:A.StartAuthenticate,payload:{tree:a,type:u||"service"}}),f=l(r),[4,N(fetch(f.url.toString(),f.init),i.timeout)];case 1:return p=d.sent(),[4,this.getResponseJson(p)];case 2:return[2,d.sent()]}}))}))},t.constructUrl=function(t,e,n,r){var o=n?{authIndexType:"service",authIndexValue:n}:void 0,i=q(q({},r),o),a=Object.keys(i).length>0?"?"+V(i):"",u=R("authenticate",e,t.paths);return U(t.baseUrl,""+u+a)},t.configureRequest=function(t){return{body:t?JSON.stringify(t):void 0,credentials:"include",headers:new Headers({accept:"application/json","accept-api-version":"protocol=1.0,resource=2.1","content-type":"application/json","x-requested-with":"forgerock-sdk"}),method:"POST"}},t.getResponseJson=function(t){return D(this,void 0,void 0,(function(){var e,n,r;return $(this,(function(o){switch(o.label){case 0:return e=t.headers.get("content-type"),e&&e.indexOf("application/json")>-1?[4,t.json()]:[3,2];case 1:return r=o.sent(),[3,3];case 2:r={},o.label=3;case 3:return(n=r).status=t.status,n.ok=t.ok,[2,n]}}))}))},t}();!function(t){t.BadRequest="BAD_REQUEST",t.Timeout="TIMEOUT",t.Unauthorized="UNAUTHORIZED",t.Unknown="UNKNOWN"}(L||(L={})),function(t){t.BooleanAttributeInputCallback="BooleanAttributeInputCallback",t.ChoiceCallback="ChoiceCallback",t.ConfirmationCallback="ConfirmationCallback",t.DeviceProfileCallback="DeviceProfileCallback",t.HiddenValueCallback="HiddenValueCallback",t.KbaCreateCallback="KbaCreateCallback",t.MetadataCallback="MetadataCallback",t.NameCallback="NameCallback",t.NumberAttributeInputCallback="NumberAttributeInputCallback",t.PasswordCallback="PasswordCallback",t.PollingWaitCallback="PollingWaitCallback",t.ReCaptchaCallback="ReCaptchaCallback",t.RedirectCallback="RedirectCallback",t.SelectIdPCallback="SelectIdPCallback",t.StringAttributeInputCallback="StringAttributeInputCallback",t.SuspendedTextOutputCallback="SuspendedTextOutputCallback",t.TermsAndConditionsCallback="TermsAndConditionsCallback",t.TextOutputCallback="TextOutputCallback",t.ValidatedCreatePasswordCallback="ValidatedCreatePasswordCallback",t.ValidatedCreateUsernameCallback="ValidatedCreateUsernameCallback"}(M||(M={}));var H,z,G=function(){function t(){this.callbacks={}}return t.prototype.addEventListener=function(t,e){!function(t,e,n){t[e]=t[e]||[],t[e].indexOf(n)<0&&t[e].push(n)}(this.callbacks,t,e)},t.prototype.removeEventListener=function(t,e){!function(t,e,n){if(t[e]){var r=t[e].indexOf(n);r>=0&&t[e].splice(r,1)}}(this.callbacks,t,e)},t.prototype.clearEventListeners=function(t){!function(t,e){Object.keys(t).forEach((function(n){e&&n!==e||delete t[n]}))}(this.callbacks,t)},t.prototype.dispatchEvent=function(t){if(this.callbacks[t.type])for(var e=0,n=this.callbacks[t.type];e<n.length;e++){(0,n[e])(t)}},t}();function K(t,e,n){return 1===t?e:void 0!==n?n:e+"s"}function W(t,e,n){return t&&void 0!==t[e]?t[e]:n}!function(t){t.CannotContainCharacters="CANNOT_CONTAIN_CHARACTERS",t.CannotContainDuplicates="CANNOT_CONTAIN_DUPLICATES",t.CannotContainOthers="CANNOT_CONTAIN_OTHERS",t.LeastCapitalLetters="AT_LEAST_X_CAPITAL_LETTERS",t.LeastNumbers="AT_LEAST_X_NUMBERS",t.MatchRegexp="MATCH_REGEXP",t.MaximumLength="MAX_LENGTH",t.MaximumNumber="MAXIMUM_NUMBER_VALUE",t.MinimumLength="MIN_LENGTH",t.MinimumNumber="MINIMUM_NUMBER_VALUE",t.Required="REQUIRED",t.Unique="UNIQUE",t.UnknownPolicy="UNKNOWN_POLICY",t.ValidArrayItems="VALID_ARRAY_ITEMS",t.ValidDate="VALID_DATE",t.ValidEmailAddress="VALID_EMAIL_ADDRESS_FORMAT",t.ValidNameFormat="VALID_NAME_FORMAT",t.ValidNumber="VALID_NUMBER",t.ValidPhoneFormat="VALID_PHONE_FORMAT",t.ValidQueryFilter="VALID_QUERY_FILTER",t.ValidType="VALID_TYPE"}(H||(H={}));var J,Q=((z={})[H.CannotContainCharacters]=function(t,e){return t+' must not contain following characters: "'+W(e,"forbiddenChars","")+'"'},z[H.CannotContainDuplicates]=function(t,e){return t+'  must not contain duplicates: "'+W(e,"duplicateValue","")+'"'},z[H.CannotContainOthers]=function(t,e){return t+' must not contain: "'+W(e,"disallowedFields","")+'"'},z[H.LeastCapitalLetters]=function(t,e){var n=W(e,"numCaps",0);return t+" must contain at least "+n+" capital "+K(n,"letter")},z[H.LeastNumbers]=function(t,e){var n=W(e,"numNums",0);return t+" must contain at least "+n+" numeric "+K(n,"value")},z[H.MatchRegexp]=function(t){return t+' has failed the "MATCH_REGEXP" policy'},z[H.MaximumLength]=function(t,e){var n=W(e,"maxLength",0);return t+" must be at most "+n+" "+K(n,"character")},z[H.MaximumNumber]=function(t){return t+' has failed the "MAXIMUM_NUMBER_VALUE" policy'},z[H.MinimumLength]=function(t,e){var n=W(e,"minLength",0);return t+" must be at least "+n+" "+K(n,"character")},z[H.MinimumNumber]=function(t){return t+' has failed the "MINIMUM_NUMBER_VALUE" policy'},z[H.Required]=function(t){return t+" is required"},z[H.Unique]=function(t){return t+" must be unique"},z[H.UnknownPolicy]=function(t,e){return t+': Unknown policy requirement "'+W(e,"policyRequirement","Unknown")+'"'},z[H.ValidArrayItems]=function(t){return t+' has failed the "VALID_ARRAY_ITEMS" policy'},z[H.ValidDate]=function(t){return t+" has an invalid date"},z[H.ValidEmailAddress]=function(t){return t+" has an invalid email address"},z[H.ValidNameFormat]=function(t){return t+" has an invalid name format"},z[H.ValidNumber]=function(t){return t+" has an invalid number"},z[H.ValidPhoneFormat]=function(t){return t+" has an invalid phone number"},z[H.ValidQueryFilter]=function(t){return t+' has failed the "VALID_QUERY_FILTER" policy'},z[H.ValidType]=function(t){return t+' has failed the "VALID_TYPE" policy'},z),X=function(){return X=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},X.apply(this,arguments)},Y=function(){function t(){}return t.parseErrors=function(t,e){var n=this,r=[];return t.detail&&t.detail.failedPolicyRequirements&&t.detail.failedPolicyRequirements.map((function(t){r.push.apply(r,[{detail:t,messages:n.parseFailedPolicyRequirement(t,e)}])})),r},t.parseFailedPolicyRequirement=function(t,e){var n=this,r=[];return t.policyRequirements.map((function(o){r.push(n.parsePolicyRequirement(t.property,o,e))})),r},t.parsePolicyRequirement=function(t,e,n){void 0===n&&(n={});var r="string"==typeof e?JSON.parse(e):X({},e),o=r.policyRequirement;return(n[o]||Q[o]||Q[H.UnknownPolicy])(t,r.params?X(X({},r.params),{policyRequirement:o}):{policyRequirement:o})},t}();!function(t){t.LoginFailure="LoginFailure",t.LoginSuccess="LoginSuccess",t.Step="Step"}(J||(J={}));var Z,tt=function(){function t(t){this.payload=t,this.type=J.LoginFailure}return t.prototype.getCode=function(){return Number(this.payload.code)},t.prototype.getDetail=function(){return this.payload.detail},t.prototype.getMessage=function(){return this.payload.message},t.prototype.getProcessedMessage=function(t){return Y.parseErrors(this.payload,t)},t.prototype.getReason=function(){return this.payload.reason},t}(),et=function(){function t(t){this.payload=t,this.type=J.LoginSuccess}return t.prototype.getRealm=function(){return this.payload.realm},t.prototype.getSessionToken=function(){return this.payload.tokenId},t.prototype.getSuccessUrl=function(){return this.payload.successUrl},t}(),nt=function(){function t(t){this.payload=t}return t.prototype.getType=function(){return this.payload.type},t.prototype.getInputValue=function(t){return void 0===t&&(t=0),this.getArrayElement(this.payload.input,t).value},t.prototype.setInputValue=function(t,e){void 0===e&&(e=0),this.getArrayElement(this.payload.input,e).value=t},t.prototype.getOutputValue=function(t){return void 0===t&&(t=0),this.getArrayElement(this.payload.output,t).value},t.prototype.getOutputByName=function(t,e){var n=this.payload.output.find((function(e){return e.name===t}));return n?n.value:e},t.prototype.getArrayElement=function(t,e){if(void 0===e&&(e=0),void 0===t)throw new Error("No NameValue array was provided to search (selector "+e+")");if("number"==typeof e){if(e<0||e>t.length-1)throw new Error("Selector index "+e+" is out of range");return t[e]}if("string"==typeof e){if(!(n=t.find((function(t){return t.name===e}))))throw new Error('Missing callback input entry "'+e+'"');return n}if("object"==typeof e&&e.test&&e.exec){var n;if(!(n=t.find((function(t){return e.test(t.name)}))))throw new Error('Missing callback input entry "'+e+'"');return n}throw new Error("Invalid selector value type")},t}(),rt=(Z=function(t,e){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Z(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Z(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ot=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return rt(e,t),e.prototype.getName=function(){return this.getOutputByName("name","")},e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.isRequired=function(){return this.getOutputByName("required",!1)},e.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},e.prototype.getPolicies=function(){return this.getOutputByName("policies",{})},e.prototype.setValidateOnly=function(t){this.setInputValue(t,/validateOnly/)},e.prototype.setValue=function(t){this.setInputValue(t)},e}(nt),it=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),at=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return it(e,t),e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.getDefaultChoice=function(){return this.getOutputByName("defaultChoice",0)},e.prototype.getChoices=function(){return this.getOutputByName("choices",[])},e.prototype.setChoiceIndex=function(t){var e=this.getChoices().length;if(t<0||t>e-1)throw new Error(t+" is out of bounds");this.setInputValue(t)},e.prototype.setChoiceValue=function(t){var e=this.getChoices().indexOf(t);if(-1===e)throw new Error('"'+t+'" is not a valid choice');this.setInputValue(e)},e}(nt),ut=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ct=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return ut(e,t),e.prototype.getDefaultOption=function(){return Number(this.getOutputByName("defaultOption",0))},e.prototype.getMessageType=function(){return Number(this.getOutputByName("messageType",0))},e.prototype.getOptions=function(){return this.getOutputByName("options",[])},e.prototype.getOptionType=function(){return Number(this.getOutputByName("optionType",0))},e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.setOptionIndex=function(t){if(0!==t&&1!==t)throw new Error('"'+t+'" is not a valid choice');this.setInputValue(t)},e.prototype.setOptionValue=function(t){var e=this.getOptions().indexOf(t);if(-1===e)throw new Error('"'+t+'" is not a valid choice');this.setInputValue(e)},e}(nt),st=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return st(e,t),e.prototype.getMessage=function(){return this.getOutputByName("message","")},e.prototype.isMetadataRequired=function(){return this.getOutputByName("metadata",!1)},e.prototype.isLocationRequired=function(){return this.getOutputByName("location",!1)},e.prototype.setProfile=function(t){this.setInputValue(JSON.stringify(t))},e}(nt),ft=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return ft(e,t),e}(nt),dt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ht=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return dt(e,t),e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.getPredefinedQuestions=function(){return this.getOutputByName("predefinedQuestions",[])},e.prototype.setQuestion=function(t){this.setValue("question",t)},e.prototype.setAnswer=function(t){this.setValue("answer",t)},e.prototype.setValue=function(t,e){if(!this.payload.input)throw new Error("KBA payload is missing input");var n=this.payload.input.find((function(e){return e.name.endsWith(t)}));if(!n)throw new Error('No input has name ending in "'+t+'"');n.value=e},e}(nt),yt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return yt(e,t),e.prototype.getData=function(){return this.getOutputByName("data",{})},e}(nt),gt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return gt(e,t),e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.setName=function(t){this.setInputValue(t)},e}(nt),bt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return bt(e,t),e.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},e.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.setPassword=function(t){this.setInputValue(t)},e}(nt),_t=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ot=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return _t(e,t),e.prototype.getMessage=function(){return this.getOutputByName("message","")},e.prototype.getWaitTime=function(){return Number(this.getOutputByName("waitTime",0))},e}(nt),Ct=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return Ct(e,t),e.prototype.getSiteKey=function(){return this.getOutputByName("recaptchaSiteKey","")},e.prototype.setResult=function(t){this.setInputValue(t)},e}(nt),Et=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return Et(e,t),e.prototype.getRedirectUrl=function(){return this.getOutputByName("redirectUrl","")},e}(nt),St=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),At=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return St(e,t),e.prototype.getProviders=function(){return this.getOutputByName("providers",[])},e.prototype.setProvider=function(t){var e=this.getProviders().find((function(e){return e.provider===t}));if(!e)throw new Error('"'+t+'" is not a valid choice');this.setInputValue(e.provider)},e}(nt),Pt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return Pt(e,t),e.prototype.getMessage=function(){return this.getOutputByName("message","")},e.prototype.getMessageType=function(){return this.getOutputByName("messageType","")},e}(nt),Nt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),It=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return Nt(e,t),e}(xt),jt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return jt(e,t),e.prototype.getTerms=function(){return this.getOutputByName("terms","")},e.prototype.getVersion=function(){return this.getOutputByName("version","")},e.prototype.getCreateDate=function(){var t=this.getOutputByName("createDate","");return new Date(t)},e.prototype.setAccepted=function(t){void 0===t&&(t=!0),this.setInputValue(t)},e}(nt),Ut=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return Ut(e,t),e.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},e.prototype.getPolicies=function(){return this.getOutputByName("policies",{})},e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.isRequired=function(){return this.getOutputByName("required",!1)},e.prototype.setPassword=function(t){this.setInputValue(t)},e.prototype.setValidateOnly=function(t){this.setInputValue(t,/validateOnly/)},e}(nt),Bt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return Bt(e,t),e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},e.prototype.getPolicies=function(){return this.getOutputByName("policies",{})},e.prototype.isRequired=function(){return this.getOutputByName("required",!1)},e.prototype.setName=function(t){this.setInputValue(t)},e.prototype.setValidateOnly=function(t){this.setInputValue(t,/validateOnly/)},e}(nt);function Mt(t){switch(t.type){case M.BooleanAttributeInputCallback:return new ot(t);case M.ChoiceCallback:return new at(t);case M.ConfirmationCallback:return new ct(t);case M.DeviceProfileCallback:return new lt(t);case M.HiddenValueCallback:return new pt(t);case M.KbaCreateCallback:return new ht(t);case M.MetadataCallback:return new vt(t);case M.NameCallback:return new wt(t);case M.NumberAttributeInputCallback:return new ot(t);case M.PasswordCallback:return new mt(t);case M.PollingWaitCallback:return new Ot(t);case M.ReCaptchaCallback:return new kt(t);case M.RedirectCallback:return new Tt(t);case M.SelectIdPCallback:return new At(t);case M.StringAttributeInputCallback:return new ot(t);case M.SuspendedTextOutputCallback:return new It(t);case M.TermsAndConditionsCallback:return new Rt(t);case M.TextOutputCallback:return new xt(t);case M.ValidatedCreatePasswordCallback:return new Vt(t);case M.ValidatedCreateUsernameCallback:return new Lt(t);default:return new nt(t)}}var qt=function(){function t(t,e){this.payload=t,this.type=J.Step,this.callbacks=[],t.callbacks&&(this.callbacks=this.convertCallbacks(t.callbacks,e))}return t.prototype.getCallbackOfType=function(t){var e=this.getCallbacksOfType(t);if(1!==e.length)throw new Error('Expected 1 callback of type "'+t+'", but found '+e.length);return e[0]},t.prototype.getCallbacksOfType=function(t){return this.callbacks.filter((function(e){return e.getType()===t}))},t.prototype.setCallbackValue=function(t,e){var n=this.getCallbacksOfType(t);if(1!==n.length)throw new Error('Expected 1 callback of type "'+t+'", but found '+n.length);n[0].setInputValue(e)},t.prototype.getDescription=function(){return this.payload.description},t.prototype.getHeader=function(){return this.payload.header},t.prototype.getStage=function(){return this.payload.stage},t.prototype.convertCallbacks=function(t,e){return t.map((function(t){return(e||Mt)(t)||Mt(t)}))},t}(),Dt=function(){return Dt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Dt.apply(this,arguments)},$t=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},Ft=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ht=function(){function t(){}return t.next=function(t,e){return $t(this,void 0,void 0,(function(){var n,r;return Ft(this,(function(o){switch(o.label){case 0:return[4,F.next(t?t.payload:void 0,e)];case 1:return(n=o.sent()).authId?(r=e?e.callbackFactory:void 0,[2,new qt(n,r)]):!n.authId&&n.ok?[2,new et(n)]:[2,new tt(n)]}}))}))},t.redirect=function(t){var e=t.getCallbackOfType(M.RedirectCallback).getRedirectUrl();window.localStorage.setItem(this.previousStepKey,JSON.stringify(t)),window.location.assign(e)},t.resume=function(t,e){return $t(this,void 0,void 0,(function(){var n,r,o,i,a,u,c,s,l,f;return Ft(this,(function(p){switch(p.label){case 0:if(n=new URL(t),r=n.searchParams.get("code"),o=n.searchParams.get("form_post_entry"),i=n.searchParams.get("nonce"),a=n.searchParams.get("scope"),u=n.searchParams.get("state"),c=n.searchParams.get("suspendedId"),r&&u||o){if(!(l=window.localStorage.getItem(this.previousStepKey)))throw new Error("Error: could not retrieve original redirect information.");try{s=JSON.parse(l)}catch(t){throw new Error("Error: could not parse redirect params or step information")}window.localStorage.removeItem(this.previousStepKey)}return f=Dt(Dt({},e),{query:Dt(Dt(Dt(Dt(Dt(Dt(Dt({},e&&e.query),r&&{code:r}),o&&{form_post_entry:o}),i&&{nonce:i}),a&&{scope:a}),u&&{state:u}),c&&{suspendedId:c})}),[4,this.next(s,f)];case 1:return[2,p.sent()]}}))}))},t.start=function(e){return $t(this,void 0,void 0,(function(){return Ft(this,(function(n){switch(n.label){case 0:return[4,t.next(void 0,e)];case 1:return[2,n.sent()]}}))}))},t.previousStepKey="FRAuth_PreviousStep",t}(),zt=["userAgent","appName","appCodeName","appVersion","appMinorVersion","buildID","product","productSub","vendor","vendorSub","browserLanguage"],Gt=["fontNames","displayProps","browserProps","hardwareProps","platformProps"],Kt={mac:["Macintosh","MacIntel","MacPPC","Mac68K"],windows:["Win32","Win64","Windows","WinCE"],ios:["iPhone","iPad","iPod"]},Wt=["width","height","pixelDepth","orientation.angle"],Jt=["cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona"],Qt=["cpuClass","deviceMemory","hardwareConcurrency","maxTouchPoints","oscpu"],Xt=["language","platform","userLanguage","systemLanguage"],Yt=function(){function t(){}return t.prototype.reduceToObject=function(t,e){return t.reduce((function(t,n){if(n.includes(".")){var r=n.split("."),o=r[0],i=r[1],a=e[o]&&e[o][i];t[i]=null!=a?a:""}else t[n]=null!=e[n]?e[n]:null;return t}),{})},t.prototype.reduceToString=function(t,e){return t.reduce((function(t,n){return t=""+t+e[n].filename+";"}),"")},t}(),Zt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),te=function(){return te=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},te.apply(this,arguments)},ee=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},ne=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};!function(t){function e(e){var n=t.call(this)||this;return n.config={fontNames:Jt,devicePlatforms:Kt,displayProps:Wt,browserProps:zt,hardwareProps:Qt,platformProps:Xt},e&&Object.keys(e).forEach((function(t){if(!Gt.includes(t))throw new Error("Device profile configuration category does not exist.");n.config[t]=e[t]})),n}Zt(e,t),e.prototype.getBrowserMeta=function(){return navigator?this.reduceToObject(this.config.browserProps,navigator):(console.warn("Cannot collect browser metadata. navigator is not defined."),{})},e.prototype.getBrowserPluginsNames=function(){return navigator&&navigator.plugins?this.reduceToString(Object.keys(navigator.plugins),navigator.plugins):(console.warn("Cannot collect browser plugin information. navigator.plugins is not defined."),"")},e.prototype.getDeviceName=function(){if(!navigator)return console.warn("Cannot collect device name. navigator is not defined."),"";var t=navigator.userAgent,e=navigator.platform;switch(!0){case this.config.devicePlatforms.mac.includes(e):return"Mac (Browser)";case this.config.devicePlatforms.ios.includes(e):return e+" (Browser)";case this.config.devicePlatforms.windows.includes(e):return"Windows (Browser)";case/Android/.test(e)||/Android/.test(t):return"Android (Browser)";case/CrOS/.test(t)||/Chromebook/.test(t):return"Chrome OS (Browser)";case/Linux/.test(e):return"Linux (Browser)";default:return(e||"Unknown")+" (Browser)"}},e.prototype.getDisplayMeta=function(){return screen||console.warn("Cannot collect screen information. screen is not defined."),this.reduceToObject(this.config.displayProps,screen)},e.prototype.getHardwareMeta=function(){return navigator?this.reduceToObject(this.config.hardwareProps,navigator):(console.warn("Cannot collect OS metadata. Navigator is not defined."),{})},e.prototype.getIdentifier=function(){if(!window.crypto||!window.crypto.getRandomValues)return console.warn("Cannot generate profile ID. Crypto and/or getRandomValues is not supported."),"";if(!localStorage)return console.warn("Cannot store profile ID. localStorage is not supported."),"";var t=localStorage.getItem("profile-id");return t||(t=window.crypto.getRandomValues(new Uint32Array(3)).join("-"),localStorage.setItem("profile-id",t)),t},e.prototype.getInstalledFonts=function(){var t=document.createElement("canvas");if(!t)return console.warn("Cannot collect font data. Browser does not support canvas element"),"";var e=t.getContext&&t.getContext("2d");if(!e)return console.warn("Cannot collect font data. Browser does not support 2d canvas context"),"";var n="abcdefghi0123456789";e.font="72px Comic Sans";var r=e.measureText(n).width;return this.config.fontNames.reduce((function(t,o){return e.font="72px "+o+", Comic Sans",e.measureText(n).width!==r&&(t=""+t+o+";"),t}),"")},e.prototype.getLocationCoordinates=function(){return ee(this,void 0,void 0,(function(){var t=this;return ne(this,(function(e){return navigator&&navigator.geolocation?[2,new Promise((function(e){return ee(t,void 0,void 0,(function(){return ne(this,(function(t){return navigator.geolocation.getCurrentPosition((function(t){return e({latitude:t.coords.latitude,longitude:t.coords.longitude})}),(function(t){console.warn("Cannot collect geolocation information. "+t.code+": "+t.message),e({})}),{enableHighAccuracy:!0,timeout:3e4,maximumAge:0}),[2]}))}))}))]:(console.warn("Cannot collect geolocation information. navigator.geolocation is not defined."),[2,Promise.resolve({})])}))}))},e.prototype.getOSMeta=function(){return navigator?this.reduceToObject(this.config.platformProps,navigator):(console.warn("Cannot collect OS metadata. navigator is not defined."),{})},e.prototype.getProfile=function(t){var e=t.location,n=t.metadata;return ee(this,void 0,void 0,(function(){var t,r;return ne(this,(function(o){switch(o.label){case 0:return t={identifier:this.getIdentifier()},n&&(t.metadata={hardware:te(te({},this.getHardwareMeta()),{display:this.getDisplayMeta()}),browser:te(te({},this.getBrowserMeta()),{plugins:this.getBrowserPluginsNames()}),platform:te(te({},this.getOSMeta()),{deviceName:this.getDeviceName(),fonts:this.getInstalledFonts(),timezone:this.getTimezoneOffset()})}),e?(r=t,[4,this.getLocationCoordinates()]):[3,2];case 1:r.location=o.sent(),o.label=2;case 2:return[2,t]}}))}))},e.prototype.getTimezoneOffset=function(){try{return(new Date).getTimezoneOffset()}catch(t){return console.warn("Cannot collect timezone information. getTimezoneOffset is not defined."),null}}}(Yt);var re="forgerock-sdk",oe=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},ie=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ae=function(){function t(){}return t.get=function(t){return oe(this,void 0,void 0,(function(){return ie(this,(function(e){return[2,new Promise((function(e,n){var r=function(){return n()},o=window.indexedDB.open(re);o.onsuccess=function(){if(!o.result.objectStoreNames.contains(t))return o.result.close(),n("Client ID not found");var i=o.result.transaction(t,"readonly").objectStore(t).get("tokens");i.onsuccess=function(t){if(!t||!t.target)throw new Error("Missing storage event target");o.result.close(),e(t.target.result)},i.onerror=r},o.onupgradeneeded=function(){o.result.close(),n("IndexedDB upgrade needed")},o.onerror=r}))]}))}))},t.set=function(t,e){return oe(this,void 0,void 0,(function(){return ie(this,(function(n){return[2,new Promise((function(n,r){var o=window.indexedDB.open(re),i=function(){o.result.close(),n()},a=function(){return r()},u=function(){o.result.createObjectStore(t)},c=function(){if(!o.result.objectStoreNames.contains(t)){var n=o.result.version+1;return o.result.close(),(o=window.indexedDB.open(re,n)).onupgradeneeded=u,o.onsuccess=c,void(o.onerror=a)}var r=o.result.transaction(t,"readwrite");r.onerror=a;var s=r.objectStore(t).put(e,"tokens");s.onsuccess=i,s.onerror=a};o.onupgradeneeded=u,o.onsuccess=c,o.onerror=a}))]}))}))},t.remove=function(t){return oe(this,void 0,void 0,(function(){return ie(this,(function(e){return[2,new Promise((function(e,n){var r=function(){return n()},o=window.indexedDB.open(re);o.onsuccess=function(){if(!o.result.objectStoreNames.contains(t))return e();var n=o.result.transaction(t,"readwrite").objectStore(t).delete("tokens");n.onsuccess=function(){e()},n.onerror=r},o.onerror=r}))]}))}))},t}(),ue=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},ce=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},se=function(){function t(){}return t.get=function(t){return ue(this,void 0,void 0,(function(){var e;return ce(this,(function(n){e=localStorage.getItem(re+"-"+t);try{return[2,Promise.resolve(JSON.parse(e||""))]}catch(t){return console.warn("Could not parse token from localStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]}))}))},t.set=function(t,e){return ue(this,void 0,void 0,(function(){var n;return ce(this,(function(r){return n=JSON.stringify(e),localStorage.setItem(re+"-"+t,n),[2]}))}))},t.remove=function(t){return ue(this,void 0,void 0,(function(){return ce(this,(function(e){return localStorage.removeItem(re+"-"+t),[2]}))}))},t}(),le=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},fe=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},pe=function(){function t(){}return t.get=function(t){return le(this,void 0,void 0,(function(){var e;return fe(this,(function(n){e=sessionStorage.getItem(re+"-"+t);try{return[2,Promise.resolve(JSON.parse(e||""))]}catch(t){return console.warn("Could not parse token from sessionStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]}))}))},t.set=function(t,e){return le(this,void 0,void 0,(function(){var n;return fe(this,(function(r){return n=JSON.stringify(e),sessionStorage.setItem(re+"-"+t,n),[2]}))}))},t.remove=function(t){return le(this,void 0,void 0,(function(){return fe(this,(function(e){return sessionStorage.removeItem(re+"-"+t),[2]}))}))},t}(),de=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},he=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ye=function(){function t(){}return t.get=function(){return de(this,void 0,void 0,(function(){var t,e,n;return he(this,(function(r){switch(r.label){case 0:return t=this.getClientConfig(),e=t.clientId,"sessionStorage"!==(n=t.tokenStore)?[3,2]:[4,pe.get(e)];case 1:case 3:case 5:case 7:case 9:return[2,r.sent()];case 2:return"localStorage"!==n?[3,4]:[4,se.get(e)];case 4:return"indexedDB"!==n?[3,6]:[4,ae.get(e)];case 6:return n&&n.get?[4,n.get(e)]:[3,8];case 8:return[4,se.get(e)]}}))}))},t.set=function(t){return de(this,void 0,void 0,(function(){var e,n,r;return he(this,(function(o){switch(o.label){case 0:return e=this.getClientConfig(),n=e.clientId,"sessionStorage"!==(r=e.tokenStore)?[3,2]:[4,pe.set(n,t)];case 1:case 3:case 5:case 7:case 9:return[2,o.sent()];case 2:return"localStorage"!==r?[3,4]:[4,se.set(n,t)];case 4:return"indexedDB"!==r?[3,6]:[4,ae.set(n,t)];case 6:return r&&r.set?[4,r.set(n,t)]:[3,8];case 8:return[4,se.set(n,t)]}}))}))},t.remove=function(){return de(this,void 0,void 0,(function(){var t,e,n;return he(this,(function(r){switch(r.label){case 0:return t=this.getClientConfig(),e=t.clientId,"sessionStorage"!==(n=t.tokenStore)?[3,2]:[4,pe.remove(e)];case 1:case 3:case 5:case 7:case 9:return[2,r.sent()];case 2:return"localStorage"!==n?[3,4]:[4,se.remove(e)];case 4:return"indexedDB"!==n?[3,6]:[4,ae.remove(e)];case 6:return n&&n.remove?[4,n.remove(e)]:[3,8];case 8:return[4,se.remove(e)]}}))}))},t.getClientConfig=function(){var t=x.get(),e=t.clientId,n=t.tokenStore;if(!e)throw new Error("clientId is required to manage token storage");return{clientId:e,tokenStore:n}},t}();function ve(t){return t.ok||4===Math.floor(t.status/100)}var ge,we=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},be=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},me=function(){function t(){}return t.createState=function(){return this.createRandomString(16)},t.createVerifier=function(){return this.createRandomString(32)},t.createChallenge=function(t){return we(this,void 0,void 0,(function(){var e;return be(this,(function(n){switch(n.label){case 0:return[4,this.sha256(t)];case 1:return e=n.sent(),[2,this.base64UrlEncode(e)]}}))}))},t.base64UrlEncode=function(t){var e=Array.prototype.slice.call(t);return window.btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},t.sha256=function(t){return we(this,void 0,void 0,(function(){var e,n;return be(this,(function(r){switch(r.label){case 0:return e=(new TextEncoder).encode(t),[4,window.crypto.subtle.digest("SHA-256",e)];case 1:return n=r.sent(),[2,new Uint8Array(n)]}}))}))},t.createRandomString=function(t){void 0===t&&(t=32);var e=new Uint8Array(t);return window.crypto.getRandomValues(e),btoa(e.join("")).replace(/[^a-zA-Z0-9]+/,"")},t}();!function(t){t.Code="code",t.Token="token"}(ge||(ge={}));var _e,Oe,Ce,ke=function(){return ke=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},ke.apply(this,arguments)},Ee=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},Te=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Se="Authentication or consent required",Ae="Authorization timed out",Pe="Failed to fetch",xe="NetworkError when attempting to fetch resource.",Ne="Cross-origin redirection",Ie=function(){function t(){}return t.createAuthorizeUrl=function(t){return Ee(this,void 0,void 0,(function(){var e,n,r,o,i,a,u,c;return Te(this,(function(s){switch(s.label){case 0:return e=x.get(t),n=e.clientId,r=e.middleware,o=e.redirectUri,i=e.scope,a=ke(ke({},t.query),{client_id:n,redirect_uri:o,response_type:t.responseType,scope:i,state:t.state}),t.verifier?[4,me.createChallenge(t.verifier)]:[3,2];case 1:u=s.sent(),a.code_challenge=u,a.code_challenge_method="S256",s.label=2;case 2:return c=B({url:new URL(this.getUrl("authorize",a,t)),init:{}},{type:A.Authorize}),[2,c(r).url.toString()]}}))}))},t.getAuthCodeByIframe=function(t){return Ee(this,void 0,void 0,(function(){var e,n,r=this;return Te(this,(function(o){switch(o.label){case 0:return[4,this.createAuthorizeUrl(t)];case 1:return e=o.sent(),n=x.get(t).serverConfig,[2,new Promise((function(t,o){var i,a=document.createElement("iframe"),u=function(){},c=u,s=0;i=function(){window.clearTimeout(s),a.removeEventListener("load",c),a.remove()},c=function(){if(a.contentWindow){var e=a.contentWindow.location.href;(r.containsAuthCode(e)||r.containsAuthError(e))&&(i(),t(e))}},s=window.setTimeout((function(){i(),o(new Error(Ae))}),n.timeout),a.style.display="none",a.addEventListener("load",c),document.body.appendChild(a),a.src=e}))]}}))}))},t.getOAuth2Tokens=function(t){return Ee(this,void 0,void 0,(function(){var e,n,r,o,i,a,u,c,s,l;return Te(this,(function(f){switch(f.label){case 0:return e=x.get(t),n=e.clientId,r=e.redirectUri,o={client_id:n,code:t.authorizationCode,grant_type:"authorization_code",redirect_uri:r},t.verifier&&(o.code_verifier=t.verifier),i=V(o),a={body:i,headers:new Headers({"content-length":i.length.toString(),"content-type":"application/x-www-form-urlencoded"}),method:"POST"},[4,this.request("accessToken",void 0,!1,a,t)];case 1:return u=f.sent(),[4,this.getBody(u)];case 2:if(c=f.sent(),200!==u.status)throw s="string"==typeof c?"Expected 200, received "+u.status:this.parseError(c),new Error(s);if(!(l=c).access_token)throw new Error("Access token not found in response");return[2,{accessToken:l.access_token,idToken:l.id_token,refreshToken:l.refresh_token}]}}))}))},t.getUserInfo=function(t){return Ee(this,void 0,void 0,(function(){var e;return Te(this,(function(n){switch(n.label){case 0:return[4,this.request("userInfo",void 0,!0,void 0,t)];case 1:if(200!==(e=n.sent()).status)throw new Error("Failed to get user info; received "+e.status);return[4,e.json()];case 2:return[2,n.sent()]}}))}))},t.endSession=function(t){return Ee(this,void 0,void 0,(function(){var e,n,r;return Te(this,(function(o){switch(o.label){case 0:return[4,ye.get()];case 1:return e=o.sent().idToken,n={},e&&(n.id_token_hint=e),[4,this.request("endSession",n,!0,void 0,t)];case 2:if(!ve(r=o.sent()))throw new Error("Failed to end session; received "+r.status);return[2,r]}}))}))},t.revokeToken=function(t){return Ee(this,void 0,void 0,(function(){var e,n,r,o;return Te(this,(function(i){switch(i.label){case 0:return e=x.get(t).clientId,[4,ye.get()];case 1:return n=i.sent().accessToken,r={body:V({client_id:e,token:n}),credentials:"include",headers:new Headers({"content-type":"application/x-www-form-urlencoded"}),method:"POST"},[4,this.request("revoke",void 0,!1,r,t)];case 2:if(!ve(o=i.sent()))throw new Error("Failed to revoke token; received "+o.status);return[2,o]}}))}))},t.request=function(t,e,n,r,o){return Ee(this,void 0,void 0,(function(){var i,a,u,c,s,l,f,p;return Te(this,(function(d){switch(d.label){case 0:return i=x.get(o),a=i.middleware,u=i.serverConfig,c=this.getUrl(t,e,o),s=function(t){switch(t){case"accessToken":return A.ExchangeToken;case"endSession":return A.EndSession;case"revoke":return A.RevokeToken;default:return A.UserInfo}},r=r||{},n?[4,ye.get()]:[3,2];case 1:l=d.sent().accessToken,r.credentials="include",r.headers=r.headers||new Headers,r.headers.set("authorization","Bearer "+l),d.label=2;case 2:return f=B({url:new URL(c),init:r},{type:s(t)}),p=f(a),[4,N(fetch(p.url.toString(),p.init),u.timeout)];case 3:return[2,d.sent()]}}))}))},t.containsAuthCode=function(t){return!!t&&/code=([^&]+)/.test(t)},t.containsAuthError=function(t){return!!t&&/error=([^&]+)/.test(t)},t.getBody=function(t){return Ee(this,void 0,void 0,(function(){var e;return Te(this,(function(n){switch(n.label){case 0:return(e=t.headers.get("content-type"))&&e.indexOf("application/json")>-1?[4,t.json()]:[3,2];case 1:case 3:return[2,n.sent()];case 2:return[4,t.text()]}}))}))},t.parseError=function(t){if(t){if(t.error&&t.error_description)return t.error+": "+t.error_description;if(t.code&&t.message)return t.code+": "+t.message}},t.getUrl=function(t,e,n){var r=x.get(n),o=r.realmPath,i=r.serverConfig,a=R(t,o,i.paths),u=U(i.baseUrl,a);return e&&(u+="?"+V(e)),u},t}(),je=function(){return je=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},je.apply(this,arguments)},Re=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},Ue=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ve=function(){function t(){}return t.getTokens=function(e){var n,r,o;return Re(this,void 0,void 0,(function(){var i,a,u,c,s,l,f,p,d,h,y,v,g,w,b,m,_,O,C,k,E;return Ue(this,(function(T){switch(T.label){case 0:i=null,a=x.get(e),u=a.clientId,c=a.middleware,s=a.serverConfig,l=a.support,T.label=1;case 1:return T.trys.push([1,3,,4]),[4,ye.get()];case 2:return i=T.sent(),[3,4];case 3:return f=T.sent(),console.info("No stored tokens available",f),[3,4];case 4:if(i&&!(null==e?void 0:e.forceRenew)&&!(null===(n=null==e?void 0:e.query)||void 0===n?void 0:n.code))return[2,i];if(!i)return[3,9];T.label=5;case 5:return T.trys.push([5,8,,9]),[4,Ie.revokeToken(e)];case 6:return T.sent(),[4,t.deleteTokens()];case 7:return T.sent(),[3,9];case 8:return p=T.sent(),console.warn("Existing tokens could not be revoked or deleted",p),[3,9];case 9:return(null===(r=null==e?void 0:e.query)||void 0===r?void 0:r.code)&&(null===(o=null==e?void 0:e.query)||void 0===o?void 0:o.state)?(d=window.sessionStorage.getItem(u),window.sessionStorage.removeItem(u),h=JSON.parse(d),[4,this.tokenExchange(e,h)]):[3,11];case 10:return[2,T.sent()];case 11:return y=me.createVerifier(),v=me.createState(),g=je(je({},e),{responseType:ge.Code,state:v,verifier:y}),[4,Ie.createAuthorizeUrl(g)];case 12:w=T.sent(),T.label=13;case 13:return T.trys.push([13,18,,19]),b=void 0,"legacy"!==l&&void 0!==l?[3,15]:(m=URL.bind,[4,Ie.getAuthCodeByIframe(g)]);case 14:return b=new(m.apply(URL,[void 0,T.sent()])),[3,17];case 15:return _=B({url:new URL(w),init:{credentials:"include",mode:"cors"}},{type:A.Authorize}),O=_(c).init,[4,N(fetch(w,O),s.timeout)];case 16:C=T.sent(),b=new URL(C.url),T.label=17;case 17:if(b.searchParams.get("error"))throw Error(""+b.searchParams.get("error_description"));if(!b.searchParams.get("code"))throw Error(Se);return S=b.toString(),P=new URL(S),I={},P.searchParams.forEach((function(t,e){return I[e]=t})),k=I,e||(e={}),e.query=k,[3,19];case 18:if(!((E=T.sent())instanceof Error)||"redirect"!==(null==e?void 0:e.login))throw E;if(Se!==E.message&&Ae!==E.message&&Pe!==E.message&&xe!==E.message&&!E.message.includes(Ne))throw E;return window.sessionStorage.setItem(u,JSON.stringify(g)),[2,window.location.assign(w)];case 19:return[4,this.tokenExchange(e,{state:v,verifier:y})];case 20:return[2,T.sent()]}var S,P,I}))}))},t.deleteTokens=function(){return Re(this,void 0,void 0,(function(){return Ue(this,(function(t){switch(t.label){case 0:return[4,ye.remove()];case 1:return t.sent(),[2]}}))}))},t.tokenExchange=function(t,e){var n,r,o,i;return Re(this,void 0,void 0,(function(){var a,u,c,s,l;return Ue(this,(function(f){switch(f.label){case 0:if((null===(n=t.query)||void 0===n?void 0:n.state)!==e.state)throw new Error("State mismatch");if(!(null===(r=t.query)||void 0===r?void 0:r.code)||Array.isArray(null===(o=t.query)||void 0===o?void 0:o.code))throw new Error("Failed to acquire authorization code");return a=null===(i=t.query)||void 0===i?void 0:i.code,u=e.verifier,c=je(je({},t),{authorizationCode:a,verifier:u}),[4,Ie.getOAuth2Tokens(c)];case 1:if(!(s=f.sent())||!s.accessToken)throw new Error("Unable to exchange authorization for tokens");f.label=2;case 2:return f.trys.push([2,4,,5]),[4,ye.set(s)];case 3:return f.sent(),[3,5];case 4:return l=f.sent(),console.error("Failed to store tokens",l),[3,5];case 5:return[2,s]}}))}))},t}();!function(t){t.Error="ERROR",t.Unsupported="unsupported"}(_e||(_e={})),function(t){t.AbortError="AbortError",t.DataError="DataError",t.ConstraintError="ConstraintError",t.EncodingError="EncodingError",t.InvalidError="InvalidError",t.NetworkError="NetworkError",t.NotAllowedError="NotAllowedError",t.NotSupportedError="NotSupportedError",t.SecurityError="SecurityError",t.TimeoutError="TimeoutError",t.UnknownError="UnknownError"}(Oe||(Oe={})),function(t){t[t.None=0]="None",t[t.Authentication=1]="Authentication",t[t.Registration=2]="Registration"}(Ce||(Ce={}));var Be=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},Le=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function Me(t){return Be(this,void 0,void 0,(function(){return Le(this,(function(e){switch(e.label){case 0:return[4,t.clone().json()];case 1:return[2,!!e.sent().advices]}}))}))}function qe(t){var e=new URL(t).searchParams.get("authIndexValue")||"",n=new DOMParser,r=decodeURIComponent(e),o=n.parseFromString(r,"application/xml").querySelector("Value");return o?o.innerHTML:""}function De(t){return Be(this,void 0,void 0,(function(){return Le(this,(function(e){switch(e.label){case 0:return[4,t.clone().json()];case 1:return[2,!!e.sent().callbacks]}}))}))}function $e(t){return Be(this,void 0,void 0,(function(){return Le(this,(function(e){switch(e.label){case 0:return[4,t.json()];case 1:return[2,e.sent()]}}))}))}var Fe=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),He=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},ze=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function Ge(e){let n,r,o,i;return{c(){var t;n=s("div"),r=s("div"),o=s("div"),t=e[0],i=document.createTextNode(t),l(o,"class","modal-content"),l(r,"class","modal-dialog"),l(n,"class","modal"),l(n,"tabindex","-1"),l(n,"style","display: block; margin-top: 10em;")},m(t,e){!function(t,e,n){t.insertBefore(e,n||null)}(t,n,e),u(n,r),u(r,o),u(o,i)},p(t,[e]){1&e&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(i,t[0])},i:t,o:t,d(t){t&&c(n)}}}function Ke(e,n,r){let o;const u=function(e,n=t){let r;const o=new Set;function a(t){if(i(e,t)&&(e=t,r)){const t=!S.length;for(const t of o)t[1](),S.push(t,e);if(t){for(let t=0;t<S.length;t+=2)S[t][0](S[t+1]);S.length=0}}}return{set:a,update:function(t){a(t(e))},subscribe:function(i,u=t){const c=[i,u];return o.add(c),1===o.size&&(r=n(a)||t),i(e),()=>{o.delete(c),0===o.size&&(r(),r=null)}}}}(0);return a(e,u,(t=>r(0,o=t))),x.set({clientId:"WebOAuthClient",redirectUri:"https://localhost:3000/callback",scope:"openid profile me.read",serverConfig:{baseUrl:"https://openam-crbrl-01.forgeblocks.com/am/",timeout:3e3},realmPath:"alpha",tree:"Login"}),u.set(1),setTimeout((()=>{u.set(2)}),2e3),e.$$.update=()=>{1&e.$$.dirty&&console.log(o)},[o,u]}!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Fe(e,t),e.request=function(t){return He(this,void 0,void 0,(function(){var e,n,r,o,i,a,u,c,s,l,f,p,d,h,y,v,g;return ze(this,(function(w){switch(w.label){case 0:return[4,this._request(t,!1)];case 1:return e=w.sent(),r=!1,function(t,e){return"function"==typeof e?e(t):401===t.status}(e,t.requiresNewToken)?[4,this._request(t,!0)]:[3,3];case 2:e=w.sent(),w.label=3;case 3:return t.authorization&&t.authorization.handleStep?e.redirected&&function(t){return(t.headers.get("Content-Type")||"").includes("html")&&t.url.includes("composite_advice")}(e)?(r=!0,n=function(t){var e={};return t.url.includes("AuthenticateToServiceConditionAdvice")?e.AuthenticateToServiceConditionAdvice=[qe(t.url)]:e.TransactionConditionAdvice=[qe(t.url)],{resource:"",actions:{},attributes:{},advices:e,ttl:0}}(e),[3,7]):[3,4]:[3,16];case 4:return[4,Me(e)];case 5:return w.sent()?[4,$e(e)]:[3,7];case 6:n=w.sent(),w.label=7;case 7:return n&&n.advices?(o=x.get(t.authorization.config),i=o.middleware,a=o.realmPath,u=o.serverConfig,c=function(t,e,n,r,o){var i=t.advices&&t.advices.AuthenticateToServiceConditionAdvice,a=t.advices&&t.advices.TransactionConditionAdvice,u="",c="";i?(u=i.reduce((function(t,e){return""+e+(t?" "+t:t)}),""),c="AuthenticateToServiceConditionAdvice"):a&&(u=a.reduce((function(t,e){return""+e+(t?" "+t:t)}),""),c="TransactionConditionAdvice");var s='<Advices><AttributeValuePair><Attribute name="'+c+'"/><Value>'+u+"</Value></AttributeValuePair></Advices>",l=R("authenticate",r,o),f={authIndexType:"composite_advice",authIndexValue:s};return{init:{method:"POST",credentials:"include",headers:new Headers({"Accept-API-Version":"resource=2.0, protocol=1.0"})},timeout:n,url:U(e,l+"?"+V(f))}}(n,u.baseUrl,t.timeout,a,u.paths),s=new URL(c.url),l=s.searchParams.get("authIndexType"),f=s.searchParams.get("authIndexValue"),p=B({url:new URL(c.url),init:c.init},{type:A.StartAuthenticate,payload:{type:l,tree:f}}),d=p(i),h=d.url,y=d.init,c.url=h.toString(),c.init=y,[4,this._request(c,!1)]):[3,16];case 8:return[4,De(v=w.sent())];case 9:if(!w.sent())throw new Error('Error: Initial response from auth server not a "step".');if(!((b=n).advices&&b.advices.AuthenticateToServiceConditionAdvice?Array.isArray(b.advices.AuthenticateToServiceConditionAdvice)&&b.advices.AuthenticateToServiceConditionAdvice.length>0:b.advices&&b.advices.TransactionConditionAdvice&&Array.isArray(b.advices.TransactionConditionAdvice)&&b.advices.TransactionConditionAdvice.length>0))throw new Error("Error: Transactional or Service Advice is empty.");return[4,this.stepIterator(v,t.authorization.handleStep,l,f)];case 10:w.sent(),g=void 0,w.label=11;case 11:return w.trys.push([11,13,,14]),[4,ye.get()];case 12:return g=w.sent(),[3,14];case 13:return w.sent(),[3,14];case 14:return r?t.url=function(t,e,n){var r=new URL(t);if(e.TransactionConditionAdvice){var o=e.TransactionConditionAdvice[0];r.searchParams.append("_txid",o)}return n&&n.idToken&&r.searchParams.append("_idtoken",n.idToken),r.toString()}(t.url,n.advices,g):t.init.headers=function(t,e,n){var r=new Headers(t.headers);return e.AuthenticateToServiceConditionAdvice?r.set("x-tree",e.AuthenticateToServiceConditionAdvice[0]):e.TransactionConditionAdvice&&r.set("x-txid",e.TransactionConditionAdvice[0]),n&&n.idToken&&r.set("x-idtoken",n.idToken),r}(t.init,n.advices,g),[4,this._request(t,!1)];case 15:e=w.sent(),w.label=16;case 16:return[2,e]}var b}))}))},e.setAuthHeaders=function(t,e){return He(this,void 0,void 0,(function(){var n;return ze(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,ye.get()];case 1:return n=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return n&&n.accessToken?[4,Ve.getTokens({forceRenew:e})]:[3,5];case 4:(n=r.sent())&&n.accessToken&&t.set("Authorization","Bearer "+n.accessToken),r.label=5;case 5:return[2,t]}}))}))},e.stepIterator=function(t,e,n,r){return He(this,void 0,void 0,(function(){var o,i,a=this;return ze(this,(function(u){switch(u.label){case 0:return[4,t.json()];case 1:return o=u.sent(),i=new qt(o),[2,new Promise((function(t,o){return He(a,void 0,void 0,(function(){function a(i){return He(this,void 0,void 0,(function(){var u,c;return ze(this,(function(s){switch(s.label){case 0:return[4,e(i)];case 1:return u=s.sent(),[4,Ht.next(u,{type:n,tree:r})];case 2:return(c=s.sent()).type===J.LoginSuccess?t():c.type===J.LoginFailure?o("Authentication tree failure."):a(c),[2]}}))}))}return ze(this,(function(t){return a(i),[2]}))}))}))]}}))}))},e._request=function(t,e){return He(this,void 0,void 0,(function(){var n,r,o,i,a;return ze(this,(function(u){switch(u.label){case 0:return n=t.url,r=t.init,o=t.timeout,i=new Headers(r.headers||{}),t.bypassAuthentication?[3,2]:[4,this.setAuthHeaders(i,e)];case 1:i=u.sent(),u.label=2;case 2:r.headers=i,u.label=3;case 3:return u.trys.push([3,5,,7]),[4,N(fetch(n,r),o)];case 4:return a=u.sent(),[3,7];case 5:return u.sent(),[4,N(fetch(n,{method:"GET"}),o)];case 6:return a=u.sent(),[3,7];case 7:return[2,a]}}))}))}}(G);new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),T(this,t,Ke,Ge,i,{})}}({target:document.getElementById("login-widget")});
//# sourceMappingURL=widget.js.map
